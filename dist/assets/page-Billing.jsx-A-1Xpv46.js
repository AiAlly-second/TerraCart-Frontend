import{r as o,R as Z,j as e,F as X,a as ee,b as te,u as B,c as re,d as ae,e as se}from"./vendor-react-D1Ov3a92.js";import{A as ne,m as D}from"./vendor-motion-DMcOTFRV.js";/* empty css                         */const oe="/assets/logo_new-CZBz3dRe.png",ie={header:"ðŸ½ï¸ Assistance",tapService:"ðŸ‘† Tap any service you need",speakOrType:"Speak or type your request",placeholder:"Type or speak your request...",sendButton:"ðŸ“© Send to waiter",listening:"ðŸŽ™ï¸ Listeningâ€¦",processing:"â³ Processing speechâ€¦",urgentButton:"ðŸš¨ URGENT - Call Manager",footer:"âš¡ Request sent instantly to nearest waiter",titleStart:"Start recording",titleStop:"Stop recording",alerts:{requestSentPrefix:"Request sent:",emptyRequest:"Please type or speak your request.",voiceError:"Sorry, we couldn't process your voice. Please try again.",micError:"Microphone access failed. Please allow mic permission.",urgentCalled:"ðŸš¨ Waiter called immediately!",selectTable:"Please select a table first."},services:{water:"Water",saltPepper:"Salt & Pepper",plates:"Extra Plates",cutlery:"Spoons/Forks",napkins:"Tissues/Napkins",cleanTable:"Clean Table",menuCard:"Menu Card",bill:"Bill/Check",sauce:"Chutney/Sauce",softDrinks:"Soft Drinks",lemonWater:"Lemon Water",callWaiter:"Call Waiter"}},le={header:"ðŸ½ï¸ à¤¸à¤¹à¤¾à¤¯à¤¤à¤¾",tapService:"ðŸ‘† à¤œà¤¿à¤¸ à¤¸à¥‡à¤µà¤¾ à¤•à¥€ à¤†à¤µà¤¶à¥à¤¯à¤•à¤¤à¤¾ à¤¹à¥ˆ à¤‰à¤¸ à¤ªà¤° à¤Ÿà¥ˆà¤ª à¤•à¤°à¥‡à¤‚",speakOrType:"à¤…à¤ªà¤¨à¥€ à¤°à¤¿à¤•à¥à¤µà¥‡à¤¸à¥à¤Ÿ à¤¬à¥‹à¤²à¥‡à¤‚ à¤¯à¤¾ à¤Ÿà¤¾à¤‡à¤ª à¤•à¤°à¥‡à¤‚",placeholder:"à¤…à¤ªà¤¨à¥€ à¤°à¤¿à¤•à¥à¤µà¥‡à¤¸à¥à¤Ÿ à¤¬à¥‹à¤²à¥‡à¤‚ à¤¯à¤¾ à¤Ÿà¤¾à¤‡à¤ª à¤•à¤°à¥‡à¤‚...",sendButton:"ðŸ“© à¤µà¥‡à¤Ÿà¤° à¤•à¥‹ à¤­à¥‡à¤œà¥‡à¤‚",listening:"ðŸŽ™ï¸ à¤¸à¥à¤¨ à¤°à¤¹à¤¾ à¤¹à¥ˆâ€¦",processing:"â³ à¤†à¤µà¤¾à¤œà¤¼ à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸ à¤¹à¥‹ à¤°à¤¹à¥€ à¤¹à¥ˆâ€¦",urgentButton:"ðŸš¨ à¤¤à¥à¤°à¤‚à¤¤ - à¤®à¥ˆà¤¨à¥‡à¤œà¤° à¤•à¥‹ à¤¬à¥à¤²à¤¾à¤à¤",footer:"âš¡ à¤°à¤¿à¤•à¥à¤µà¥‡à¤¸à¥à¤Ÿ à¤¤à¥à¤°à¤‚à¤¤ à¤¨à¤œà¤¼à¤¦à¥€à¤•à¥€ à¤µà¥‡à¤Ÿà¤° à¤•à¥‹ à¤­à¥‡à¤œà¥€ à¤—à¤ˆ",titleStart:"à¤°à¤¿à¤•à¥‰à¤°à¥à¤¡à¤¿à¤‚à¤— à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚",titleStop:"à¤°à¤¿à¤•à¥‰à¤°à¥à¤¡à¤¿à¤‚à¤— à¤°à¥‹à¤•à¥‡à¤‚",alerts:{requestSentPrefix:"à¤°à¤¿à¤•à¥à¤µà¥‡à¤¸à¥à¤Ÿ à¤­à¥‡à¤œà¥€ à¤—à¤ˆ:",emptyRequest:"à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤ªà¤¨à¥€ à¤°à¤¿à¤•à¥à¤µà¥‡à¤¸à¥à¤Ÿ à¤Ÿà¤¾à¤‡à¤ª à¤•à¤°à¥‡à¤‚ à¤¯à¤¾ à¤¬à¥‹à¤²à¥‡à¤‚à¥¤",voiceError:"à¤®à¤¾à¤«à¤¼ à¤•à¥€à¤œà¤¿à¤, à¤†à¤ªà¤•à¥€ à¤†à¤µà¤¾à¤œà¤¼ à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸ à¤¨à¤¹à¥€à¤‚ à¤¹à¥‹ à¤¸à¤•à¥€à¥¤ à¤¦à¥‹à¤¬à¤¾à¤°à¤¾ à¤•à¥‹à¤¶à¤¿à¤¶ à¤•à¤°à¥‡à¤‚à¥¤",micError:"à¤®à¤¾à¤‡à¤•à¥à¤°à¥‹à¤«à¤¼à¥‹à¤¨ à¤…à¤¨à¥à¤®à¤¤à¤¿ à¤…à¤¸à¤«à¤²à¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤¨à¥à¤®à¤¤à¤¿ à¤¦à¥‡à¤‚à¥¤",urgentCalled:"ðŸš¨ à¤µà¥‡à¤Ÿà¤° à¤•à¥‹ à¤¤à¥à¤°à¤‚à¤¤ à¤¬à¥à¤²à¤¾à¤¯à¤¾ à¤—à¤¯à¤¾!"},services:{water:"à¤ªà¤¾à¤¨à¥€",saltPepper:"à¤¨à¤®à¤• à¤”à¤° à¤•à¤¾à¤²à¥€ à¤®à¤¿à¤°à¥à¤š",plates:"à¤…à¤¤à¤¿à¤°à¤¿à¤•à¥à¤¤ à¤ªà¥à¤²à¥‡à¤Ÿà¥‡à¤‚",cutlery:"à¤šà¤®à¥à¤®à¤š/à¤•à¤¾à¤‚à¤Ÿà¥‡",napkins:"à¤Ÿà¤¿à¤¶à¥à¤¯à¥‚/à¤¨à¥ˆà¤ªà¤•à¤¿à¤¨",cleanTable:"à¤Ÿà¥‡à¤¬à¤² à¤¸à¤¾à¤« à¤•à¤°à¥‡à¤‚",menuCard:"à¤®à¥‡à¤¨à¥‚ à¤•à¤¾à¤°à¥à¤¡",bill:"à¤¬à¤¿à¤²/à¤šà¥‡à¤•",sauce:"à¤šà¤Ÿà¤¨à¥€/à¤¸à¥‰à¤¸",softDrinks:"à¤¸à¥‰à¤«à¥à¤Ÿ à¤¡à¥à¤°à¤¿à¤‚à¤•à¥à¤¸",lemonWater:"à¤¨à¥€à¤‚à¤¬à¥‚ à¤ªà¤¾à¤¨à¥€",callWaiter:"à¤µà¥‡à¤Ÿà¤° à¤•à¥‹ à¤¬à¥à¤²à¤¾à¤à¤"}},ce={header:"ðŸ½ï¸ à¤®à¤¦à¤¤",tapService:"ðŸ‘† à¤†à¤µà¤¶à¥à¤¯à¤• à¤¸à¥‡à¤µà¤¾ à¤¨à¤¿à¤µà¤¡à¤¾",speakOrType:"à¤¤à¥à¤®à¤šà¥€ à¤µà¤¿à¤¨à¤‚à¤¤à¥€ à¤¬à¥‹à¤²à¤¾ à¤•à¤¿à¤‚à¤µà¤¾ à¤Ÿà¤¾à¤‡à¤ª à¤•à¤°à¤¾",placeholder:"à¤¤à¥à¤®à¤šà¥€ à¤µà¤¿à¤¨à¤‚à¤¤à¥€ à¤¬à¥‹à¤²à¤¾ à¤•à¤¿à¤‚à¤µà¤¾ à¤Ÿà¤¾à¤‡à¤ª à¤•à¤°à¤¾...",sendButton:"ðŸ“© à¤µà¥‡à¤Ÿà¤°à¤²à¤¾ à¤ªà¤¾à¤ à¤µà¤¾",listening:"ðŸŽ™ï¸ à¤à¤•à¤¤ à¤†à¤¹à¥‡â€¦",processing:"â³ à¤†à¤µà¤¾à¤œ à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸ à¤•à¤°à¤¤ à¤†à¤¹à¥‡â€¦",urgentButton:"ðŸš¨ à¤¤à¤¾à¤¤à¤¡à¥€à¤šà¥‡ - à¤®à¥…à¤¨à¥‡à¤œà¤°à¤²à¤¾ à¤¬à¥‹à¤²à¤µà¤¾",footer:"âš¡ à¤µà¤¿à¤¨à¤‚à¤¤à¥€ à¤œà¤µà¤³à¤šà¥à¤¯à¤¾ à¤µà¥‡à¤Ÿà¤°à¤•à¤¡à¥‡ à¤¤à¤¤à¥à¤•à¤¾à¤³ à¤ªà¤¾à¤ à¤µà¤²à¥€",titleStart:"à¤°à¥‡à¤•à¥‰à¤°à¥à¤¡à¤¿à¤‚à¤— à¤¸à¥à¤°à¥‚ à¤•à¤°à¤¾",titleStop:"à¤°à¥‡à¤•à¥‰à¤°à¥à¤¡à¤¿à¤‚à¤— à¤¥à¤¾à¤‚à¤¬à¤µà¤¾",alerts:{requestSentPrefix:"à¤µà¤¿à¤¨à¤‚à¤¤à¥€ à¤ªà¤¾à¤ à¤µà¤²à¥€:",emptyRequest:"à¤•à¥ƒà¤ªà¤¯à¤¾ à¤¤à¥à¤®à¤šà¥€ à¤µà¤¿à¤¨à¤‚à¤¤à¥€ à¤Ÿà¤¾à¤‡à¤ª à¤•à¤°à¤¾ à¤•à¤¿à¤‚à¤µà¤¾ à¤¬à¥‹à¤²à¤¾.",voiceError:"à¤•à¥à¤·à¤®à¤¸à¥à¤µ, à¤†à¤µà¤¾à¤œ à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸ à¤•à¤°à¤¤à¤¾ à¤†à¤²à¤¾ à¤¨à¤¾à¤¹à¥€. à¤ªà¥à¤¨à¥à¤¹à¤¾ à¤ªà¥à¤°à¤¯à¤¤à¥à¤¨ à¤•à¤°à¤¾.",micError:"à¤®à¤¾à¤¯à¤•à¥à¤°à¥‹à¤«à¥‹à¤¨ à¤ªà¤°à¤µà¤¾à¤¨à¤—à¥€ à¤…à¤¯à¤¶à¤¸à¥à¤µà¥€. à¤•à¥ƒà¤ªà¤¯à¤¾ à¤ªà¤°à¤µà¤¾à¤¨à¤—à¥€ à¤¦à¥à¤¯à¤¾.",urgentCalled:"ðŸš¨ à¤µà¥‡à¤Ÿà¤°à¤²à¤¾ à¤¤à¤¾à¤¤à¤¡à¥€à¤¨à¥‡ à¤¬à¥‹à¤²à¤¾à¤µà¤²à¥‡!"},services:{water:"à¤ªà¤¾à¤£à¥€",saltPepper:"à¤®à¥€à¤  à¤†à¤£à¤¿ à¤®à¤¿à¤°à¥€",plates:"à¤…à¤¤à¤¿à¤°à¤¿à¤•à¥à¤¤ à¤ªà¥à¤²à¥‡à¤Ÿà¥à¤¸",cutlery:"à¤šà¤®à¤šà¥‡/à¤•à¤¾à¤Ÿà¥‡",napkins:"à¤Ÿà¤¿à¤¶à¥à¤¯à¥‚/à¤¨à¥…à¤ªà¤•à¤¿à¤¨",cleanTable:"à¤Ÿà¥‡à¤¬à¤² à¤¸à¥à¤µà¤šà¥à¤› à¤•à¤°à¤¾",menuCard:"à¤®à¥‡à¤¨à¥à¤¯à¥‚ à¤•à¤¾à¤°à¥à¤¡",bill:"à¤¬à¤¿à¤²/à¤šà¥‡à¤•",sauce:"à¤šà¤Ÿà¤£à¥€/à¤¸à¥‰à¤¸",softDrinks:"à¤¸à¥‰à¤«à¥à¤Ÿ à¤¡à¥à¤°à¤¿à¤‚à¤•à¥à¤¸",lemonWater:"à¤²à¤¿à¤‚à¤¬à¥‚ à¤ªà¤¾à¤£à¥€",callWaiter:"à¤µà¥‡à¤Ÿà¤°à¤²à¤¾ à¤¬à¥‹à¤²à¤µà¤¾"}},de={header:"ðŸ½ï¸ àª®àª¦àª¦",tapService:"ðŸ‘† àª¤àª®àª¨à«‡ àªœà«‡ àª¸à«‡àªµàª¾ àªœà«‹àªˆàª àª¤à«‡ àªªàª° àªŸà«‡àªª àª•àª°à«‹",speakOrType:"àª¤àª®àª¾àª°à«€ àªµàª¿àª¨àª‚àª¤à«€ àª¬à«‹àª²à«‹ àª…àª¥àªµàª¾ àª²àª–à«‹",placeholder:"àª¤àª®àª¾àª°à«€ àªµàª¿àª¨àª‚àª¤à«€ àª¬à«‹àª²à«‹ àª…àª¥àªµàª¾ àª²àª–à«‹...",sendButton:"ðŸ“© àªµà«‡àªˆàªŸàª°àª¨à«‡ àª®à«‹àª•àª²à«‹",listening:"ðŸŽ™ï¸ àª¸àª¾àª‚àª­àª³àªµàª¾àª®àª¾àª‚ àª†àªµà«€ àª°àª¹à«àª¯à«àª‚ àª›à«‡â€¦",processing:"â³ àª…àªµàª¾àªœ àªªà«àª°àª•à«àª°àª¿àª¯àª¾ àª¥àªˆ àª°àª¹à«€ àª›à«‡â€¦",urgentButton:"ðŸš¨ àª¤àª¾àª¤à«àª•àª¾àª²àª¿àª• - àª®à«‡àª¨à«‡àªœàª°àª¨à«‡ àª¬à«‹àª²àª¾àªµà«‹",footer:"âš¡ àªµàª¿àª¨àª‚àª¤à«€ àª¤àª°àª¤ àª¨àªœà«€àª•àª¨àª¾ àªµà«‡àªˆàªŸàª°àª¨à«‡ àª®à«‹àª•àª²àª¾àªˆ",titleStart:"àª°à«€àª•à«‹àª°à«àª¡àª¿àª‚àª— àª¶àª°à«‚ àª•àª°à«‹",titleStop:"àª°à«€àª•à«‹àª°à«àª¡àª¿àª‚àª— àª¬àª‚àª§ àª•àª°à«‹",alerts:{requestSentPrefix:"àªµàª¿àª¨àª‚àª¤à«€ àª®à«‹àª•àª²àª¾àªˆ:",emptyRequest:"àª•à«ƒàªªàª¾ àª•àª°à«€àª¨à«‡ àª¤àª®àª¾àª°à«€ àªµàª¿àª¨àª‚àª¤à«€ àª²àª–à«‹ àª…àª¥àªµàª¾ àª¬à«‹àª²à«‹.",voiceError:"àª®àª¾àª« àª•àª°àª¶à«‹, àª…àªµàª¾àªœ àªªà«àª°à«‹àª¸à«‡àª¸ àª¨ àª¥àªˆ àª¶àª•à«àª¯à«‹. àª«àª°à«€ àªªà«àª°àª¯àª¤à«àª¨ àª•àª°à«‹.",micError:"àª®àª¾àª‡àª•àª¨à«€ àªªàª°àªµàª¾àª¨àª—à«€ àª¨àª¿àª·à«àª«àª³. àª•à«ƒàªªàª¾ àª•àª°à«€àª¨à«‡ àªªàª°àªµàª¾àª¨àª—à«€ àª†àªªà«‹.",urgentCalled:"ðŸš¨ àªµà«‡àªˆàªŸàª°àª¨à«‡ àª¤àª°àª¤ àª¬à«‹àª²àª¾àªµàªµàª¾àª®àª¾àª‚ àª†àªµà«àª¯à«‹!"},services:{water:"àªªàª¾àª£à«€",saltPepper:"àª®à«€àª à«àª‚ àª…àª¨à«‡ àª®àª°à«€",plates:"àªµàª§àª¾àª°àª¾àª¨à«€ àª¥àª¾àª³à«€àª“",cutlery:"àªšàª®àªšà«€/àª•àª¾àª‚àªŸàª¾",napkins:"àªŸàª¿àª¶à«àª¯à«/àª¨à«‡àªªàª•àª¿àª¨",cleanTable:"àªŸà«‡àª¬àª² àª¸àª¾àª« àª•àª°à«‹",menuCard:"àª®à«‡àª¨à« àª•àª¾àª°à«àª¡",bill:"àª¬àª¿àª²/àªšà«‡àª•",sauce:"àªšàªŸàª£à«€/àª¸à«‹àª¸",softDrinks:"àª¸à«‹àª«à«àªŸ àª¡à«àª°àª¿àª‚àª•à«àª¸",lemonWater:"àª²à«€àª‚àª¬à« àªªàª¾àª£à«€",callWaiter:"àªµà«‡àªˆàªŸàª°àª¨à«‡ àª¬à«‹àª²àª¾àªµà«‹"}},L={en:ie,hi:le,mr:ce,gu:de};function ue({showCard:d,setShowCard:a,currentTable:l,onTableSelect:u}){const g=(()=>{try{return localStorage.getItem("language")||"en"}catch{return"en"}})(),r=L[g]||L.en,[m,h]=o.useState(()=>l||localStorage.getItem("selectedTable")||""),[C,R]=o.useState(null),[M,q]=o.useState(!l),[i,j]=o.useState([]),[P,E]=o.useState(!1);Z.useEffect(()=>{d&&(async()=>{try{E(!0);const s="https://api.terracart.in".replace(/\/$/,""),n=localStorage.getItem("terra_selectedTable");let p=null;n&&(p=JSON.parse(n).cartId);const c=p?`${s}/api/tables/public?cartId=${p}`:`${s}/api/tables/public`,y=await(await fetch(c)).json();Array.isArray(y)&&j(y)}catch(s){console.error("Failed to fetch tables:",s)}finally{E(!1)}})()},[d]);const v=Array.from({length:20},(t,s)=>String(s+1)),_=[{icon:"ðŸ’§",key:"water"},{icon:"ðŸ§‚",key:"saltPepper"},{icon:"ðŸ½ï¸",key:"plates"},{icon:"ðŸ¥„",key:"cutlery"},{icon:"ðŸ§»",key:"napkins"},{icon:"ðŸ§½",key:"cleanTable"},{icon:"ðŸ“‹",key:"menuCard"},{icon:"ðŸ’³",key:"bill"},{icon:"ðŸŒ¶ï¸",key:"sauce"},{icon:"ðŸ¥¤",key:"softDrinks"},{icon:"ðŸ‹",key:"lemonWater"},{icon:"ðŸ””",key:"callWaiter"}],[N,b]=o.useState(""),[x,S]=o.useState(!1),[T,$]=o.useState(!1),[f,O]=o.useState(!1),W=o.useRef(null),U=t=>({water:"water",saltPepper:"assistance",plates:"assistance",cutlery:"cutlery",napkins:"napkins",cleanTable:"assistance",menuCard:"menu",bill:"bill",sauce:"assistance",softDrinks:"assistance",lemonWater:"water",callWaiter:"assistance"})[t]||"assistance",V=async t=>{if(!f)try{O(!0);const s=localStorage.getItem("terra_selectedTable"),n=s?JSON.parse(s):{};let p=n.id||n._id,c=n.number||n.tableNumber||l||m;if(!p&&c){const F=i.find(Q=>String(Q.number)===String(c));F&&(p=F._id)}if(!p){alert(r.alerts.selectTable||"Please select a valid table first so we know where to send the waiter.");return}const w=localStorage.getItem("terra_orderId")||null,y="https://api.terracart.in".replace(/\/$/,""),k={tableId:p,requestType:U(t),customerNotes:r.services[t]||t,...w&&{orderId:w}},I=await fetch(`${y}/api/customer-requests`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),A=await I.json();if(!I.ok)throw new Error(A.message||"Failed to send request");alert(`âœ… ${r.alerts.requestSentPrefix||"Request sent"}: ${r.services[t]} - Table ${c}`),a(!1)}catch(s){console.error("Error sending service request:",s),alert(`âŒ Failed to send request: ${s.message}`)}finally{O(!1)}},H=async()=>{if(!N.trim()){alert(r.alerts.emptyRequest||"Please enter your request");return}if(!f)try{O(!0);const t=localStorage.getItem("terra_selectedTable"),s=t?JSON.parse(t):{};let n=s.id||s._id,p=s.number||s.tableNumber||l||m;if(!n&&p){const A=i.find(F=>String(F.number)===String(p));A&&(n=A._id)}if(!n){alert(r.alerts.selectTable||"Please select a valid table first so we know where to send the waiter.");return}const c=localStorage.getItem("terra_orderId")||null,w="https://api.terracart.in".replace(/\/$/,""),y={tableId:n,requestType:"assistance",customerNotes:N.trim(),...c&&{orderId:c}},k=await fetch(`${w}/api/customer-requests`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)}),I=await k.json();if(!k.ok)throw new Error(I.message||"Failed to send request");alert(`âœ… ${r.alerts.requestSentPrefix||"Request sent"}: ${N.trim()}`),b(""),a(!1)}catch(t){console.error("Error sending custom request:",t),alert(`âŒ Failed to send request: ${t.message}`)}finally{O(!1)}},K=async()=>{if(!f)try{O(!0);const t=localStorage.getItem("terra_selectedTable"),s=t?JSON.parse(t):{};let n=s.id||s._id,p=s.number||s.tableNumber||l||m;if(!n&&p){const A=i.find(F=>String(F.number)===String(p));A&&(n=A._id)}if(!n){alert(r.alerts.selectTable||"Please select a valid table first so we know where to send the waiter.");return}const c=localStorage.getItem("terra_orderId")||null,w="https://api.terracart.in".replace(/\/$/,""),y={tableId:n,requestType:"assistance",customerNotes:"URGENT: Call waiter immediately",...c&&{orderId:c}},k=await fetch(`${w}/api/customer-requests`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)}),I=await k.json();if(!k.ok)throw new Error(I.message||"Failed to send urgent request");alert(r.alerts.urgentCalled||"âœ… Urgent request sent! A waiter will be with you shortly."),a(!1)}catch(t){console.error("Error sending urgent request:",t),alert(`âŒ Failed to send urgent request: ${t.message}`)}finally{O(!1)}},z=()=>{try{W.current&&(W.current.stop(),W.current=null)}catch(t){console.warn("Error stopping recognition:",t)}S(!1)},G=async()=>{if(x){z();return}if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window)){alert("Your browser doesn't support voice input. Please type your request instead.");return}try{const t=window.SpeechRecognition||window.webkitSpeechRecognition,s=new t;W.current=s,s.continuous=!1,s.interimResults=!1,s.lang=g==="en"?"en-US":g==="hi"?"hi-IN":"en-US",s.onstart=()=>{S(!0),console.log("ðŸŽ¤ Voice recognition started")},s.onresult=async n=>{const p=n.results[0][0].transcript;console.log("ðŸ“ Transcribed:",p),b(p),S(!1),$(!0);try{const c="http://localhost:5050".replace(/\/$/,""),w=await fetch(`${c}/parse-order-text`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:p}),signal:AbortSignal.timeout(1e4)});if(!w.ok){const k=await w.json().catch(()=>({}));throw new Error(k.error||`Backend returned ${w.status}`)}const y=await w.json();if(y.items&&y.items.length>0){const k=y.items.map(I=>`${I.quantity}x ${I.name}`).join(", ");b(k),console.log("âœ… Parsed order:",y)}else y.error&&console.warn("Backend parsing error:",y.error)}catch(c){console.error("Order parsing failed:",c),c.name==="TypeError"||c.message.includes("fetch")||c.message.includes("Failed to fetch")?alert(`âŒ Cannot connect to backend server. Please make sure Flask server is running on port 5050.

You can still type your order manually.`):c.name==="AbortError"||c.message.includes("timeout")?alert(`â±ï¸ Request timed out. The backend server may be slow or unavailable.

You can still type your order manually.`):alert(`âš ï¸ Order parsing failed: ${c.message}

You can still see your transcribed text and type manually.`)}finally{$(!1)}},s.onerror=n=>{console.error("Voice recognition error:",n.error),S(!1),n.error==="no-speech"?alert("No speech detected. Please try again."):n.error==="not-allowed"?alert("Microphone permission denied. Please allow microphone access."):alert(r.alerts.voiceError||"Voice recognition error. Please try typing instead.")},s.onend=()=>{S(!1),W.current=null},s.start()}catch(t){console.error("Error starting voice recognition:",t),alert(r.alerts.micError||"Failed to start voice input. Please try typing instead."),S(!1)}};return d?e.jsx("div",{style:{position:"fixed",inset:0,width:"100%",maxWidth:"100vw",height:"100vh",backgroundColor:"rgba(0,0,0,0.75)",zIndex:1e6,display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",boxSizing:"border-box"},onClick:()=>{z(),a(!1)},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:16,boxShadow:"0 25px 50px -12px rgba(0,0,0,0.5)",width:"100%",maxWidth:420,maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column",position:"relative"},onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:16,borderBottom:"1px solid #e5e7eb",background:"linear-gradient(to right, #fff7ed, white)"},children:[e.jsxs("h3",{style:{fontSize:18,fontWeight:"bold",color:"#d97706",margin:0},children:[r.header," ",m?`- Table ${m}`:""]}),e.jsx("button",{onClick:()=>{z(),a(!1)},style:{padding:8,borderRadius:"50%",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"#6b7280"},title:"Close",children:e.jsx(X,{size:18})})]}),e.jsxs("div",{style:{padding:16,borderBottom:"1px solid #e5e7eb"},children:[e.jsx("p",{style:{fontSize:14,marginBottom:8,fontWeight:500},children:l?"Assigned Table":"Select Table:"}),l?e.jsxs("div",{style:{padding:12,borderRadius:8,border:"1px solid #dbeafe",backgroundColor:"#eff6ff",color:"#1d4ed8",fontWeight:600,textAlign:"center"},children:["Table ",l]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:8},children:v.map(t=>e.jsx("button",{onClick:()=>{h(t),localStorage.setItem("selectedTable",t),u&&u(t)},style:{padding:8,borderRadius:6,border:"1px solid #e5e7eb",backgroundColor:m===t?"#16a34a":"white",color:m===t?"white":"#374151",cursor:"pointer",fontWeight:"500"},children:t},t))})]}),e.jsxs("div",{style:{padding:16,overflowY:"auto",flex:1},children:[e.jsx("p",{style:{fontSize:14,color:"#6b7280",marginBottom:16,textAlign:"center",fontWeight:500},children:r.tapService}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16},children:_.map((t,s)=>e.jsxs("button",{onClick:()=>V(t.key),disabled:f,style:{padding:12,borderRadius:8,border:"1px solid #e5e7eb",backgroundColor:"white",cursor:f?"not-allowed":"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:8,transition:"all 0.2s",boxShadow:"0 1px 3px 0 rgba(0,0,0,0.1)",opacity:f?.6:1},onMouseOver:n=>{n.currentTarget.style.borderColor="#fb923c",n.currentTarget.style.backgroundColor="#fff7ed"},onMouseOut:n=>{n.currentTarget.style.borderColor="#e5e7eb",n.currentTarget.style.backgroundColor="white"},children:[e.jsx("span",{style:{fontSize:20},children:t.icon}),e.jsx("span",{style:{fontSize:12,fontWeight:500,textAlign:"center",lineHeight:1.2,color:"#374151"},children:r.services[t.key]})]},s))}),e.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,backgroundColor:"#fff7ed"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151"},children:r.speakOrType}),e.jsx("button",{onClick:G,disabled:T,style:{padding:8,borderRadius:"9999px",border:"none",cursor:"pointer",color:"white",backgroundColor:x?"#dc2626":"#16a34a",opacity:T?.7:1},title:x?r.titleStop:r.titleStart,children:x?e.jsx(ee,{size:16}):e.jsx(te,{size:16})})]}),e.jsx("textarea",{placeholder:r.placeholder,rows:3,value:N,onChange:t=>b(t.target.value),style:{width:"100%",padding:10,borderRadius:8,border:"1px solid #e5e7eb",outline:"none",resize:"vertical",fontSize:13,backgroundColor:"white"}}),e.jsx("button",{onClick:H,disabled:T||f,style:{width:"100%",marginTop:10,padding:"10px 12px",borderRadius:8,fontWeight:700,fontSize:14,backgroundColor:"#f97316",color:"white",border:"none",cursor:T||f?"not-allowed":"pointer",boxShadow:"0 4px 6px -1px rgba(0,0,0,0.1)",opacity:T||f?.7:1},onMouseOver:t=>{t.currentTarget.style.backgroundColor="#ea580c"},onMouseOut:t=>{t.currentTarget.style.backgroundColor="#f97316"},children:r.sendButton}),x&&e.jsx("p",{style:{marginTop:8,fontSize:12,color:"#dc2626",textAlign:"right"},children:r.listening}),(T||f)&&e.jsx("p",{style:{marginTop:6,fontSize:12,color:"#6b7280",textAlign:"right"},children:f?r.sending||"Sending request...":r.processing})]}),e.jsx("button",{onClick:K,disabled:f,style:{width:"100%",marginTop:16,padding:"12px 16px",borderRadius:8,fontWeight:"bold",fontSize:14,backgroundColor:"#dc2626",color:"white",border:"none",cursor:f?"not-allowed":"pointer",boxShadow:"0 4px 6px -1px rgba(0,0,0,0.1)",opacity:f?.6:1},onMouseOver:t=>{t.currentTarget.style.backgroundColor="#b91c1c"},onMouseOut:t=>{t.currentTarget.style.backgroundColor="#dc2626"},children:r.urgentButton})]}),e.jsx("div",{style:{padding:"12px 16px",borderTop:"1px solid #e5e7eb",backgroundColor:"#f9fafb",textAlign:"center"},children:e.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:0},children:r.footer})})]})}):null}const ge={tableService:"Assistance",signName:"Talk with Hands",signMenu:"Sign Menu"},pe={tableService:"à¤®à¤¦à¤¦",signName:"à¤¹à¤¾à¤µà¤­à¤¾à¤µ à¤¸à¥‡ à¤¬à¤¾à¤¤ à¤•à¤°à¥‡à¤‚",signMenu:"à¤¸à¤¾à¤‡à¤¨ à¤®à¥‡à¤¨à¥à¤¯à¥‚"},me={tableService:"à¤®à¤¦à¤¤",signName:"à¤¹à¤¾à¤µà¤­à¤¾à¤µà¤¾à¤¨à¥‡ à¤¬à¥‹à¤²à¤¾",signMenu:"à¤¸à¤¾à¤‡à¤¨ à¤®à¥‡à¤¨à¥‚"},be={tableService:"àª®àª¦àª¦",signName:"àª¹àª¾àªµàª­àª¾àªµàª¥à«€ àªµàª¾àª¤ àª•àª°à«‹",signMenu:"àª¸àª¾àª‡àª¨ àª®à«‡àª¨à«‚"},Y={en:ge,hi:pe,mr:me,gu:be};function fe({activeTab:d,setActiveTab:a,accessibilityMode:l}){const u=B(),g=o.useMemo(()=>{try{return localStorage.getItem("language")||"en"}catch{return"en"}},[]),r=Y[g]||Y.en,h=(()=>{try{return localStorage.getItem("terra_serviceType")||"DINE_IN"}catch{return"DINE_IN"}})()==="TAKEAWAY",[C,R]=o.useState(!1),M=o.useMemo(()=>{try{const j=localStorage.getItem("terra_selectedTable")||localStorage.getItem("tableSelection")||localStorage.getItem("tableNumber");if(!j)return"";if(j.startsWith("{")){const P=JSON.parse(j);return P?.number||P?.tableNumber||""}return j}catch{return""}},[]),q="bg-white text-black border-orange-500",i="bg-white text-black hover:bg-gray-50";return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full flex border-t border-orange-500",children:[!h&&e.jsx("button",{className:`flex-1 py-2 text-xs sm:text-sm md:text-base font-medium transition-colors border-r border-orange-500 ${d==="table"?q:i}`,onClick:()=>{a("table"),R(!0)},children:r.tableService||"Assistance"}),e.jsx("button",{className:`flex-1 py-2 text-xs sm:text-sm md:text-base font-medium transition-colors ${d==="signName"?q:i}`,onClick:()=>{a("signName"),u("/sign-name")},children:r.signName||"Sign Name"})]}),!h&&e.jsx(ue,{showCard:C,setShowCard:R,language:g,accessibilityMode:l,currentTable:M})]})}function he({showNavigationTabs:d=!0,isFixed:a=!0,onClickCart:l,cartCount:u=0}){const g=B(),r=re(),[m,h]=o.useState(localStorage.getItem("language")||"en"),[C,R]=o.useState(!1),[M,q]=o.useState(!1),[i,j]=o.useState(""),[P,E]=o.useState(!1),[v,_]=o.useState(localStorage.getItem("accessibilityMode")==="true"),[N,b]=o.useState("table");o.useRef(null),o.useRef(null),o.useEffect(()=>{const T=()=>{_(localStorage.getItem("accessibilityMode")==="true"),h(localStorage.getItem("language")||"en")};return window.addEventListener("storage",T),()=>window.removeEventListener("storage",T)},[]);const x=v?"bg-black text-white border-blue-400":"bg-[#f5e3d5]/80 text-[#4a2e1f] border-[#e2c1ac]",S=a?"fixed top-0 left-0 z-[100010]":"relative";return e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:`${S} w-full flex flex-col items-center shadow-md backdrop-blur-md border-b h-20 ${x}`,style:a?{zIndex:100010}:{},children:[e.jsxs("div",{className:"w-full flex items-center justify-center relative h-20",children:[r.pathname!=="/"&&e.jsx("button",{onClick:()=>g(-1),className:`absolute left-4 p-2 rounded-full transition ${v?"text-white hover:text-blue-400":"text-[#4a2e1f] hover:text-[#d86d2a]"}`,children:e.jsx(ae,{size:28})}),e.jsx("img",{src:oe,alt:"Logo",className:"h-12 object-contain"}),l&&e.jsx("button",{onClick:l,className:`absolute right-4 p-2 rounded-full transition ${v?"text-white hover:text-blue-400":"text-[#4a2e1f] hover:text-[#d86d2a]"}`,"aria-label":"View Cart",children:e.jsxs("div",{className:"relative",children:[e.jsx(se,{size:24}),u>0&&e.jsx("span",{className:"absolute -top-1.5 -right-1.5 bg-red-600 text-white text-[10px] font-bold rounded-full h-4 w-4 flex items-center justify-center",children:u})]})})]}),d&&e.jsx(fe,{activeTab:N,setActiveTab:b,setShowCard:R,language:m,accessibilityMode:v})]}),e.jsx(ne,{children:C&&e.jsxs(e.Fragment,{children:[e.jsx(D.div,{className:"fixed inset-0 backdrop-blur-sm bg-black/30 z-[100000]",style:{zIndex:1e5},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),e.jsx(D.div,{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[100001] w-full max-w-md mx-auto p-3 sm:p-4 max-h-[90vh] overflow-y-auto",style:{zIndex:100005},initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.7},transition:{duration:.3}})]})})]})}const ye="/assets/restaurant-img-mq14w4lV.jpg",$e="/assets/m1-ZFsWq4a1.png",Ae="/assets/m2-wlV-bwDn.png",xe={loading:"Loading billing details...",fetchFailed:"âŒ Failed to fetch order.",restaurantName:"Terra Cart",table:"Table",noOrderFound:"âŒ No order found!",subtotal:"Sub-Total",tax:"Tax (5%)",total:"Total",proceedToPay:"Proceed to Pay",orderId:"Order ID",serviceType:"Service",dineIn:"Dine-In",takeaway:"Takeaway"},Se={loading:"à¤¬à¤¿à¤²à¤¿à¤‚à¤— à¤µà¤¿à¤µà¤°à¤£ à¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¤¾ à¤¹à¥ˆ...",fetchFailed:"âŒ à¤‘à¤°à¥à¤¡à¤° à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤•à¤°à¤¨à¥‡ à¤®à¥‡à¤‚ à¤µà¤¿à¤«à¤²à¥¤",restaurantName:"à¤Ÿà¥‡à¤°à¤¾ à¤•à¤¾à¤°à¥à¤Ÿ",table:"à¤Ÿà¥‡à¤¬à¤²",noOrderFound:"âŒ à¤•à¥‹à¤ˆ à¤‘à¤°à¥à¤¡à¤° à¤¨à¤¹à¥€à¤‚ à¤®à¤¿à¤²à¤¾!",subtotal:"à¤‰à¤ª-à¤¯à¥‹à¤—",tax:"à¤•à¤° (5%)",total:"à¤•à¥à¤²",proceedToPay:"à¤­à¥à¤—à¤¤à¤¾à¤¨ à¤•à¤°à¥‡à¤‚",orderId:"à¤‘à¤°à¥à¤¡à¤° à¤†à¤ˆà¤¡à¥€",serviceType:"à¤¸à¥‡à¤µà¤¾",dineIn:"à¤¡à¤¾à¤‡à¤¨-à¤‡à¤¨",takeaway:"à¤ªà¥ˆà¤•à¥‡à¤Ÿ"},we={loading:"à¤¬à¤¿à¤²à¤¿à¤‚à¤— à¤¤à¤ªà¤¶à¥€à¤² à¤²à¥‹à¤¡ à¤¹à¥‹à¤¤ à¤†à¤¹à¥‡...",fetchFailed:"âŒ à¤‘à¤°à¥à¤¡à¤° à¤®à¤¿à¤³à¤µà¤£à¥à¤¯à¤¾à¤¤ à¤…à¤¯à¤¶à¤¸à¥à¤µà¥€.",orderId:"à¤‘à¤°à¥à¤¡à¤° à¤†à¤¯à¤¡à¥€",restaurantName:"à¤Ÿà¥‡à¤°à¤¾ à¤•à¤¾à¤°à¥à¤Ÿ",table:"à¤Ÿà¥‡à¤¬à¤²",noOrderFound:"âŒ à¤‘à¤°à¥à¤¡à¤° à¤¸à¤¾à¤ªà¤¡à¤²à¤¾ à¤¨à¤¾à¤¹à¥€!",subtotal:"à¤‰à¤ª-à¤à¤•à¥‚à¤£",tax:"à¤•à¤° (5%)",total:"à¤à¤•à¥‚à¤£",proceedToPay:"à¤­à¤°à¤£à¤¾ à¤•à¤°à¤¾",serviceType:"à¤¸à¥‡à¤µà¤¾",dineIn:"à¤¡à¤¾à¤‡à¤¨-à¤‡à¤¨",takeaway:"à¤ªà¤¾à¤°à¥à¤¸à¤²"},ve={loading:"àª¬àª¿àª²àª¿àª‚àª— àªµàª¿àª—àª¤ àª²à«‹àª¡ àª¥àªˆ àª°àª¹à«€ àª›à«‡...",fetchFailed:"âŒ àª“àª°à«àª¡àª° àª®à«‡àª³àªµàªµàª¾àª®àª¾àª‚ àª¨àª¿àª·à«àª«àª³.",orderId:"àª“àª°à«àª¡àª° àª†àªˆàª¡à«€",restaurantName:"àªŸà«‡àª°àª¾ àª•àª¾àª°à«àªŸ",table:"àªŸà«‡àª¬àª²",noOrderFound:"âŒ àª•à«‹àªˆ àª“àª°à«àª¡àª° àª®àª³à«àª¯à«‹ àª¨àª¥à«€!",subtotal:"àª‰àªªàª•à«àª²",tax:"àª•àª° (5%)",total:"àª•à«àª²",proceedToPay:"àªšà«àª•àªµàª£à«€ àª•àª°à«‹",serviceType:"àª¸à«‡àªµàª¾",dineIn:"àª¡àª¾àª‡àª¨-àª‡àª¨",takeaway:"àªªàª¾àª°à«àª¸àª²"},ke={en:xe,hi:Se,mr:we,gu:ve},Te="https://api.terracart.in".replace(/\/$/,"");function J(d=[]){const a={};return d.forEach(l=>{(l?.items||[]).forEach(u=>{if(!u)return;const g=u.name||"Item";a[g]||(a[g]={name:g,quantity:0,returnedQuantity:0,price:u.price||0,returned:!1});const r=a[g];u.returned?(r.returnedQuantity+=Number(u.quantity)||0,r.returned=!0):r.quantity+=Number(u.quantity)||0,!r.price&&u.price&&(r.price=u.price)})}),Object.values(a)}function je(d){const a=d.reduce((r,m)=>{const h=Number(m.price)||0,C=Number(m.quantity)||0;return r+h*C},0),l=Number((a/100).toFixed(2));return{subtotal:l,gst:0,totalAmount:l}}function Ne(d=[]){const a=J(d);return je(a)}function Ie(){const d=B(),[a,l]=o.useState(null),[u,g]=o.useState(!0),[r,m]=o.useState(null),[h,C]=o.useState(localStorage.getItem("accessibilityMode")==="true"),[R,M]=o.useState(null),q=localStorage.getItem("language")||"en",i=b=>ke[q]?.[b]||b;o.useEffect(()=>{const x=(localStorage.getItem("terra_serviceType")||"DINE_IN")==="TAKEAWAY"&&localStorage.getItem("terra_orderId_TAKEAWAY")||localStorage.getItem("terra_orderId");if(!x){l(null),m(i("noOrderFound")||"No active order."),g(!1);return}let S=!1;return(async()=>{g(!0),m(null);try{const $=await fetch(`${Te}/api/orders/${x}`);if(!$.ok)throw new Error("Failed to fetch order");const f=await $.json();S||l(f)}catch($){S||(m(i("fetchFailed")||$.message||"Unable to load order."),l(null))}finally{S||g(!1)}})(),()=>{S=!0}},[q]);const j=()=>{if(!((localStorage.getItem("terra_serviceType")||"DINE_IN")==="TAKEAWAY"&&localStorage.getItem("terra_orderId_TAKEAWAY")||localStorage.getItem("terra_orderId"))){alert(i("noOrderFound")||"No order found");return}if(a?.status==="Paid"){alert(i("paymentCompleted")||"Payment already completed."),d("/payment");return}d("/payment")};if(u)return e.jsx("div",{className:"loading-container",children:e.jsx("p",{children:i("loading")})});if(r)return e.jsxs("div",{className:"loading-container",children:[e.jsx("p",{children:r}),e.jsx("button",{className:"proceed-button",onClick:()=>d("/menu"),children:i("returnToMenu")||"Back to menu"})]});if(!a)return e.jsxs("div",{className:"loading-container",children:[e.jsx("p",{children:i("noOrderFound")||"No active order."}),e.jsx("button",{className:"proceed-button",onClick:()=>d("/menu"),children:i("returnToMenu")||"Back to menu"})]});const P=J(a.kotLines||[]),E=Ne(a.kotLines||[]),v=a.serviceType==="TAKEAWAY",_=a.table?.number??a.tableNumber??"â€”",N=a.table?.name;return e.jsxs("div",{className:`billing-container ${h?"accessibility-mode":""}`,children:[e.jsxs("div",{className:"background-container",children:[e.jsx("img",{src:ye,alt:i("restaurantName"),className:`background-image ${h?"accessibility-mode":""}`}),e.jsx("div",{className:`background-overlay ${h?"accessibility-mode":""}`})]}),e.jsx(he,{}),e.jsx("div",{className:"content-wrapper",children:e.jsxs("div",{className:`billing-card ${h?"accessibility-mode":""}`,children:[e.jsx("h1",{className:"restaurant-title",children:i("restaurantName")}),e.jsxs("h2",{className:"order-info",children:[i("orderId"),":"," ",a._id||a.id||localStorage.getItem("terra_orderId")||"N/A"]}),v&&a.takeawayToken&&e.jsx("div",{className:"order-info",style:{marginTop:"8px",marginBottom:"8px"},children:e.jsxs("span",{style:{fontWeight:"600",color:"#2563eb"},children:["Token:"," ",e.jsx("span",{style:{fontSize:"1.2em"},children:a.takeawayToken})]})}),e.jsxs("div",{className:"table-info",children:[e.jsxs("span",{children:[i("serviceType"),": ",i(v?"takeaway":"dineIn")]}),!v&&e.jsxs("span",{children:[i("table"),": ",_,N?` Â· ${N}`:""]}),v&&(a.customerName||a.customerMobile)&&e.jsxs(e.Fragment,{children:[a.customerName&&e.jsxs("span",{children:["Name: ",a.customerName]}),a.customerMobile&&e.jsxs("span",{children:["Mobile: ",a.customerMobile]})]})]}),e.jsx("div",{className:"order-items",children:P.length===0?e.jsx("div",{className:"order-item empty-state",children:i("noItems")||"No items on this order yet."}):P.map((b,x)=>e.jsxs("div",{className:"order-item",children:[e.jsxs("span",{children:[b.name," Ã— ",b.quantity]}),e.jsxs("span",{children:["â‚¹",((b.price||0)/100*(b.quantity||0)).toFixed(2)]})]},x))}),e.jsxs("div",{className:`totals-section ${h?"accessibility-mode":""}`,children:[e.jsxs("div",{className:"total-row subtotal",children:[e.jsx("span",{children:i("subtotal")}),e.jsxs("span",{children:["â‚¹",E.subtotal.toFixed(2)]})]}),e.jsxs("div",{className:"total-row final-total",children:[e.jsx("span",{children:i("total")}),e.jsxs("span",{children:["â‚¹",E.totalAmount.toFixed(2)]})]})]}),e.jsx("button",{onClick:j,className:`proceed-button ${h?"accessibility-mode":""}`,children:i("proceedToPay")})]})})]})}const Re=Object.freeze(Object.defineProperty({__proto__:null,default:Ie},Symbol.toStringTag,{value:"Module"}));export{Re as B,he as H,Ae as a,$e as m,ye as r};
