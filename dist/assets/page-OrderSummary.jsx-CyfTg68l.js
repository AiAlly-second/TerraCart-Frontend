import{u as J,r as y,j as e}from"./vendor-react-BMxAjtiD.js";import{r as X,H as Z}from"./page-Billing.jsx-CXD1st4q.js";import{O as ee}from"./page-Menu.jsx-DDyfjchD.js";import{l as te}from"./vendor-socket-DJ_CsPWr.js";/* empty css                              */import{h as se,E as re}from"./vendor-pdf-KWoZMcRy.js";import"./vendor-CB8mghnX.js";import"./vendor-motion-iT52ZrD2.js";/* empty css                         */import"./page-CartPage.jsx-DM0lPMsA.js";/* empty css                          *//* empty css                          */const ae={loading:"Loading order summary...",orderSummary:"Order Summary",totalItems:"Total Items:",subtotal:"Subtotal:",gst:"GST (5%):",total:"Total:",cookingInstructions:"Cooking Instructions",placeholderRequests:"Any special requests...",confirmOrder:"Confirm Order",viewBill:"View Bill",orderId:"Order ID:",tableNumber:"Table Number:",close:"Close",noOrderFound:"âŒ No order found!",fetchFailed:"âŒ Failed to fetch order summary.",restaurantName:"Terra Cart",address:`Câ€‘Square, Dindori Rd,
Opp. Akash Petrol Pump,
Kalananagar, Nashik,
Maharashtra 422004`,takeawayLabel:"Takeaway",tableLabel:"Table",serviceTypeLabel:"Service",dineInLabel:"Dine-In"},ne={loading:"à¤‘à¤°à¥à¤¡à¤° à¤¸à¤¾à¤°à¤¾à¤‚à¤¶ à¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¤¾ à¤¹à¥ˆ...",orderSummary:"à¤‘à¤°à¥à¤¡à¤° à¤¸à¤¾à¤°à¤¾à¤‚à¤¶",totalItems:"à¤•à¥à¤² à¤µà¤¸à¥à¤¤à¥à¤à¤‚:",subtotal:"à¤‰à¤ª-à¤¯à¥‹à¤—:",gst:"à¤œà¥€à¤à¤¸à¤Ÿà¥€ (5%):",total:"à¤•à¥à¤²:",cookingInstructions:"à¤ªà¤•à¤¾à¤¨à¥‡ à¤•à¥‡ à¤¨à¤¿à¤°à¥à¤¦à¥‡à¤¶",placeholderRequests:"à¤•à¥‹à¤ˆ à¤µà¤¿à¤¶à¥‡à¤· à¤…à¤¨à¥à¤°à¥‹à¤§...",confirmOrder:"à¤‘à¤°à¥à¤¡à¤° à¤•à¥€ à¤ªà¥à¤·à¥à¤Ÿà¤¿ à¤•à¤°à¥‡à¤‚",viewBill:"à¤¬à¤¿à¤² à¤¦à¥‡à¤–à¥‡à¤‚",orderId:"à¤‘à¤°à¥à¤¡à¤° à¤†à¤ˆà¤¡à¥€:",tableNumber:"à¤Ÿà¥‡à¤¬à¤² à¤¨à¤‚à¤¬à¤°:",close:"à¤¬à¤‚à¤¦ à¤•à¤°à¥‡à¤‚",noOrderFound:"âŒ à¤•à¥‹à¤ˆ à¤‘à¤°à¥à¤¡à¤° à¤¨à¤¹à¥€à¤‚ à¤®à¤¿à¤²à¤¾!",fetchFailed:"âŒ à¤‘à¤°à¥à¤¡à¤° à¤¸à¤¾à¤°à¤¾à¤‚à¤¶ à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤•à¤°à¤¨à¥‡ à¤®à¥‡à¤‚ à¤µà¤¿à¤«à¤²à¥¤",restaurantName:"à¤Ÿà¥‡à¤°à¤¾ à¤•à¤¾à¤°à¥à¤Ÿ",address:`à¤¸à¥€-à¤¸à¥à¤•à¥à¤µà¤¾à¤¯à¤°, à¤¦à¤¿à¤‚à¤¡à¥‹à¤°à¥€ à¤°à¥‹à¤¡,
à¤†à¤•à¤¾à¤¶ à¤ªà¥‡à¤Ÿà¥à¤°à¥‹à¤² à¤ªà¤‚à¤ª à¤•à¥‡ à¤¸à¤¾à¤®à¤¨à¥‡,
à¤•à¤²à¤¾à¤¨à¤—à¤°, à¤¨à¤¾à¤¸à¤¿à¤•,
à¤®à¤¹à¤¾à¤°à¤¾à¤·à¥à¤Ÿà¥à¤° 422004`,takeawayLabel:"à¤ªà¥ˆà¤•à¥‡à¤Ÿ",tableLabel:"à¤Ÿà¥‡à¤¬à¤²",serviceTypeLabel:"à¤¸à¥‡à¤µà¤¾",dineInLabel:"à¤¡à¤¾à¤‡à¤¨-à¤‡à¤¨"},oe={loading:"à¤‘à¤°à¥à¤¡à¤° à¤¸à¤¾à¤°à¤¾à¤‚à¤¶ à¤²à¥‹à¤¡ à¤¹à¥‹à¤¤ à¤†à¤¹à¥‡...",orderSummary:"à¤‘à¤°à¥à¤¡à¤° à¤¸à¤¾à¤°à¤¾à¤‚à¤¶",totalItems:"à¤à¤•à¥‚à¤£ à¤µà¤¸à¥à¤¤à¥‚:",subtotal:"à¤‰à¤ª-à¤à¤•à¥‚à¤£:",gst:"à¤œà¥€à¤à¤¸à¤Ÿà¥€ (5%):",total:"à¤à¤•à¥‚à¤£:",cookingInstructions:"à¤¸à¥à¤µà¤¯à¤‚à¤ªà¤¾à¤•à¤¾à¤šà¥à¤¯à¤¾ à¤¸à¥‚à¤šà¤¨à¤¾",placeholderRequests:"à¤•à¥‹à¤£à¤¤à¥€à¤¹à¥€ à¤µà¤¿à¤¶à¥‡à¤· à¤µà¤¿à¤¨à¤‚à¤¤à¥€...",confirmOrder:"à¤‘à¤°à¥à¤¡à¤° à¤¨à¤¿à¤¶à¥à¤šà¤¿à¤¤ à¤•à¤°à¤¾",viewBill:"à¤¬à¤¿à¤² à¤ªà¤¹à¤¾",orderId:"à¤‘à¤°à¥à¤¡à¤° à¤†à¤¯à¤¡à¥€:",tableNumber:"à¤Ÿà¥‡à¤¬à¤² à¤•à¥à¤°à¤®à¤¾à¤‚à¤•:",close:"à¤¬à¤‚à¤¦ à¤•à¤°à¤¾",noOrderFound:"âŒ à¤‘à¤°à¥à¤¡à¤° à¤¸à¤¾à¤ªà¤¡à¤²à¤¾ à¤¨à¤¾à¤¹à¥€!",fetchFailed:"âŒ à¤‘à¤°à¥à¤¡à¤° à¤¸à¤¾à¤°à¤¾à¤‚à¤¶ à¤†à¤£à¤£à¥à¤¯à¤¾à¤¤ à¤…à¤¯à¤¶à¤¸à¥à¤µà¥€.",restaurantName:"à¤Ÿà¥‡à¤°à¤¾ à¤•à¤¾à¤°à¥à¤Ÿ",address:`à¤¸à¥€-à¤¸à¥à¤•à¥à¤µà¥‡à¤…à¤°, à¤¦à¤¿à¤‚à¤¡à¥‹à¤°à¥€ à¤°à¥‹à¤¡,
à¤†à¤•à¤¾à¤¶ à¤ªà¥‡à¤Ÿà¥à¤°à¥‹à¤² à¤ªà¤‚à¤ª à¤¸à¤®à¥‹à¤°,
à¤•à¤²à¤¾à¤¨à¤—à¤°, à¤¨à¤¾à¤¶à¤¿à¤•,
à¤®à¤¹à¤¾à¤°à¤¾à¤·à¥à¤Ÿà¥à¤° 422004`,takeawayLabel:"à¤ªà¤¾à¤°à¥à¤¸à¤²",tableLabel:"à¤Ÿà¥‡à¤¬à¤²",serviceTypeLabel:"à¤¸à¥‡à¤µà¤¾",dineInLabel:"à¤¡à¤¾à¤‡à¤¨-à¤‡à¤¨"},ie={loading:"àª“àª°à«àª¡àª° àª¸àª¾àª°àª¾àª‚àª¶ àª²à«‹àª¡ àª¥àªˆ àª°àª¹à«àª¯à«‹ àª›à«‡...",orderSummary:"àª“àª°à«àª¡àª° àª¸àª¾àª°àª¾àª‚àª¶",totalItems:"àª•à«àª² àªµàª¸à«àª¤à«àª“:",subtotal:"àª‰àªªàª•à«àª²:",gst:"àªœà«€àªàª¸àªŸà«€ (5%):",total:"àª•à«àª²:",cookingInstructions:"àª°àª¸à«‹àªˆ àª¸à«àªšàª¨àª¾àª“",placeholderRequests:"àª•à«‹àªˆ àª–àª¾àª¸ àªµàª¿àª¨àª‚àª¤à«€àª“...",confirmOrder:"àª“àª°à«àª¡àª° àªªà«àª·à«àªŸàª¿ àª•àª°à«‹",viewBill:"àª¬àª¿àª² àªœà«àª“",orderId:"àª“àª°à«àª¡àª° àª†àª‡àª¡à«€:",tableNumber:"àªŸà«‡àª¬àª² àª¨àª‚àª¬àª°:",close:"àª¬àª‚àª§ àª•àª°à«‹",noOrderFound:"âŒ àª•à«‹àªˆ àª“àª°à«àª¡àª° àª®àª³à«àª¯à«‹ àª¨àª¥à«€!",fetchFailed:"âŒ àª“àª°à«àª¡àª° àª¸àª¾àª°àª¾àª‚àª¶ àª®à«‡àª³àªµàªµàª¾àª®àª¾àª‚ àª¨àª¿àª·à«àª«àª³.",restaurantName:"àªŸà«‡àª°àª¾ àª•àª¾àª°à«àªŸ",address:`àª¸à«€-àª¸à«àª•à«àªµà«‡àª°, àª¦àª¿àª‚àª¡à«‹àª°à«€ àª°à«‹àª¡,
àª†àª•àª¾àª¶ àªªà«‡àªŸà«àª°à«‹àª² àªªàª‚àªª àª¸àª¾àª®à«‡,
àª•àª²àª¾àª¨àª—àª°, àª¨àª¾àª¸àª¿àª•,
àª®àª¹àª¾àª°àª¾àª·à«àªŸà«àª° 422004`,takeawayLabel:"àªªàª¾àª°à«àª¸àª²",tableLabel:"àªŸà«‡àª¬àª²",serviceTypeLabel:"àª¸à«‡àªµàª¾",dineInLabel:"àª¡àª¾àª‡àª¨-àª‡àª¨"},_={en:ae,hi:ne,mr:oe,gu:ie},K="https://api.terracart.in".replace(/\/$/,""),ce=r=>{if(r==null)return 0;const t=Number(r);return Number.isNaN(t)?0:t/100},le=r=>String(r||"").replace(/^\(\s*\+\s*\)\s*/u,"").trim()||"Add-on",H=(r=null)=>{const t={};return(Array.isArray(r?.kotLines)?r.kotLines:[]).forEach(c=>{(c?.items||[]).forEach(u=>{if(!u)return;const p=u.name||"Item",l=ce(u.price||0);t[p]||(t[p]={name:p,quantity:0,returnedQuantity:0,unitPrice:l,amount:0,returned:!1});const h=t[p];if(u.returned)h.returnedQuantity+=Number(u.quantity)||0,h.returned=!0;else{const b=Number(u.quantity)||0;h.quantity+=b,h.amount+=l*b}!h.unitPrice&&l&&(h.unitPrice=l)})}),(Array.isArray(r?.selectedAddons)?r.selectedAddons:[]).forEach(c=>{if(!c)return;const u=le(c.name),p=`addon:${c.addonId||c._id||c.id||`${u}-${c.price||0}`}`,l=Number(c.quantity)||1,h=Number(c.price)||0;t[p]||(t[p]={name:u,quantity:0,returnedQuantity:0,unitPrice:h,amount:0,returned:!1});const b=t[p];b.quantity+=l,b.amount+=h*l}),Object.values(t)},de=r=>{const t=r.reduce((u,p)=>{const l=Number(p.amount)||0;return u+l},0),i=Number(t.toFixed(2));return{subtotal:i,gst:0,totalAmount:i}},me=(r=null,t=null)=>{const i=Array.isArray(t)?t:H(r);return de(i)},ue=r=>{if(!r)return"INV-NA";const t=new Date(r.createdAt||Date.now()).toISOString().slice(0,10).replace(/-/g,""),i=(r.cartId||r._id||"").toString().slice(-6).toUpperCase();return`INV-${t}-${i}`},A=r=>{const t=Number(r);return Number.isNaN(t)?"0.00":t.toFixed(2)},he=r=>!r||!r.id?null:{employeeId:r.id,employeeName:r.name||null,employeeRole:r.role||null,disability:{hasDisability:!!r.disability,type:r.disability||null},acceptedAt:r.acceptedAt||null},pe=r=>{const t=r?.assignmentDisplayType;if(t==="TEAM"||t==="INDIVIDUAL")return t;const i=r?.assignedStaff?.role||r?.acceptedBy?.employeeRole;return String(i||"").toUpperCase()==="ADMIN"?"TEAM":"INDIVIDUAL"};function _e(){const r=J(),[t,i]=y.useState(null),[E,c]=y.useState(!1),[u,p]=y.useState(!1),[l,h]=y.useState(!1),b=y.useRef(null),[Q]=y.useState(localStorage.getItem("accessibilityMode")==="true"),R={Pending:"ðŸ“ Order is being processed...",Accepted:"âœ… Your order has been accepted! A staff member is assisting you.",Confirmed:"ðŸ‘¨â€ðŸ³ Order confirmed! Kitchen is getting ready.",Preparing:"ðŸ”¥ Your food is being prepared","Being Prepared":"ðŸ”¥ Your food is being prepared",BeingPrepared:"ðŸ”¥ Your food is being prepared",Ready:"âœ¨ Your food is ready to be served",Completed:"ðŸ“¦ Your order is ready for pickup!",Served:"ðŸ½ï¸ Enjoy your meal!",Finalized:"ðŸ“‹ Order completed, preparing bill",Paid:"âœ… Thank you for dining with us!",Cancelled:"âŒ Order has been cancelled",Returned:"â†©ï¸ Order has been returned. Please contact staff if you need assistance."},I=localStorage.getItem("language")||"en",n=a=>_[I]?.[a]||a,C=localStorage.getItem("terra_serviceType")||"DINE_IN",j=C==="TAKEAWAY"?localStorage.getItem("terra_orderId_TAKEAWAY")||localStorage.getItem("terra_orderId"):localStorage.getItem("terra_orderId_DINE_IN")||localStorage.getItem("terra_orderId");if(console.log("[OrderSummary] Loading order:",{serviceType:C,orderId:j,fromStorage:{generic:localStorage.getItem("terra_orderId"),dineIn:localStorage.getItem("terra_orderId_DINE_IN"),takeaway:localStorage.getItem("terra_orderId_TAKEAWAY")}}),y.useEffect(()=>{if(!j)return;const a=s=>{if(!s?.status)return;const d=s.serviceType||localStorage.getItem("terra_serviceType")||"DINE_IN",m=s.status,S=s.updatedAt||new Date().toISOString();localStorage.setItem("terra_orderStatus",m),localStorage.setItem("terra_orderStatusUpdatedAt",S),d==="TAKEAWAY"?(localStorage.setItem("terra_orderStatus_TAKEAWAY",m),localStorage.setItem("terra_orderStatusUpdatedAt_TAKEAWAY",S),localStorage.removeItem("terra_orderId_TAKEAWAY"),localStorage.removeItem("terra_cart_TAKEAWAY")):(localStorage.setItem("terra_orderStatus_DINE_IN",m),localStorage.setItem("terra_orderStatusUpdatedAt_DINE_IN",S),localStorage.removeItem("terra_orderId_DINE_IN")),localStorage.removeItem("terra_orderId"),localStorage.removeItem("terra_cart")},f=async()=>{try{const s=await fetch(`${K}/api/orders/${j}`);if(!s.ok){if(s.status===404)return alert(_[I]?.noOrderFound||"No order found"),r("/menu"),null;throw new Error(`Failed to fetch order: ${s.status}`)}const d=await s.json();return d?(i(d),(d.status==="Cancelled"||d.status==="Returned")&&a(d),d):(alert(_[I]?.noOrderFound||"No order found"),null)}catch(s){return console.error("Error fetching order:",s),alert(_[I]?.noOrderFound||"No order found"),null}},g=s=>{s?._id===j&&(i(s),(s.status==="Cancelled"||s.status==="Returned")&&a(s))},N=s=>{if(!s)return;const d=s.orderId||s.order?._id||s.order?.id;if(String(d||"")===String(j||"")){if(s.order&&typeof s.order=="object"){i({...s.order,assignedStaff:s.assignedStaff||s.order.assignedStaff||null,assignmentDisplayType:s.assignmentDisplayType||s.order.assignmentDisplayType||null});return}s.assignedStaff&&i(m=>m&&{...m,status:s.status||m.status,assignedStaff:s.assignedStaff,assignmentDisplayType:s.assignmentDisplayType||m.assignmentDisplayType||null,acceptedBy:he(s.assignedStaff)||m.acceptedBy})}};let o=null;try{o=te(K,{transports:["polling","websocket"],reconnection:!0,reconnectionDelay:1e3,reconnectionAttempts:5,timeout:2e4,autoConnect:!0,forceNew:!1}),o.on("connect",()=>{console.log("[OrderSummary] Socket connected")}),f().then(s=>{if(s?.cartId&&o){const d=typeof s.cartId=="object"&&s.cartId!=null?(s.cartId._id||s.cartId).toString():String(s.cartId);o.emit("join:cart",d)}}),o.on("connect_error",s=>{s.message&&!s.message.includes("xhr poll error")&&console.warn("[OrderSummary] Socket connection error:",s.message)}),o.on("disconnect",s=>{s!=="io client disconnect"&&console.log("[OrderSummary] Socket disconnected:",s)}),o.on("orderUpdated",g),o.on("order:status:updated",g),o.on("ORDER_ACCEPTED",N)}catch(s){console.warn("[OrderSummary] Failed to create socket connection:",s)}return()=>{o&&(o.off("orderUpdated",g),o.off("order:status:updated",g),o.off("ORDER_ACCEPTED",N),o.off("connect"),o.off("connect_error"),o.off("disconnect"),o.disconnect(),o=null)}},[j,I,r]),!t)return e.jsx("div",{className:"order-summary-page loading-screen",children:n("loading")});const v=H(t),T=me(t,v),L=v.reduce((a,f)=>a+f.quantity,0),x=t.serviceType==="TAKEAWAY",P=t.table?.number??t.tableNumber??"â€”",w=t.table?.name,F=n(x?"takeawayLabel":"dineInLabel"),q=ue(t),B=pe(t)==="TEAM",Y=t.acceptedBy?.employeeName||t.assignedStaff?.name,M=t.assignedStaff?.role||t.acceptedBy?.employeeRole,$=t.acceptedBy?.disability?.type||t.assignedStaff?.disability,D=typeof t.cancellationReason=="string"?t.cancellationReason.trim():"",V=async()=>{if(!(!b.current||l)){h(!0);try{const a=await se(b.current,{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff",onclone:z=>{z.querySelectorAll("*").forEach(O=>{const G=window.getComputedStyle(O);["color","backgroundColor","borderColor"].forEach(k=>{const U=G[k];U&&U.includes("oklch")&&(O.style[k]="#000000",k==="backgroundColor"&&(O.style[k]="transparent"))})})}}),f=a.toDataURL("image/png"),g=80,N=4,o=g-N*2,s=a.width,m=a.height/s,S=o*m+N*2,W=new re({orientation:"portrait",unit:"mm",format:[g,S]});W.addImage(f,"PNG",N,N,o,o*m),W.save(`${q}.pdf`)}catch(a){console.error("Invoice download failed (Detailed):",a),alert(`Failed to generate PDF: ${a.message||"Unknown error"}`)}finally{h(!1)}}};return e.jsxs("div",{className:`order-summary-page ${Q?"accessibility":""}`,children:[e.jsxs("div",{className:"background-container",children:[e.jsx("img",{src:X,alt:n("restaurantName"),className:"background-image"}),e.jsx("div",{className:"background-overlay"})]}),e.jsxs("div",{className:"content-wrapper",children:[e.jsx(Z,{}),e.jsx("div",{className:"main-content",children:e.jsxs("div",{className:"summary-card",children:[e.jsx("h2",{className:"summary-title",children:n("orderSummary")}),e.jsxs("div",{className:"order-meta",children:[e.jsxs("div",{className:"order-meta-row",children:[e.jsx("span",{children:n("orderId")}),e.jsx("span",{children:t._id||"â€”"})]}),x&&t.takeawayToken&&e.jsxs("div",{className:"order-meta-row",style:{backgroundColor:"#dbeafe",padding:"8px",borderRadius:"8px",marginBottom:"8px"},children:[e.jsx("span",{style:{fontWeight:"600",color:"#1e40af"},children:"Token:"}),e.jsx("span",{style:{fontSize:"1.2em",fontWeight:"bold",color:"#2563eb"},children:t.takeawayToken})]}),!x&&e.jsxs("div",{className:"order-meta-row",children:[e.jsx("span",{children:n("serviceTypeLabel")}),e.jsx("span",{children:F})]}),!x&&e.jsxs("div",{className:"order-meta-row",children:[e.jsx("span",{children:n("tableLabel")}),e.jsxs("span",{children:[P,w?` Â· ${w}`:""]})]}),x&&(t.customerName||t.customerMobile)&&e.jsxs(e.Fragment,{children:[t.customerName&&e.jsxs("div",{className:"order-meta-row",children:[e.jsx("span",{children:"Customer Name:"}),e.jsx("span",{children:t.customerName})]}),t.customerMobile&&e.jsxs("div",{className:"order-meta-row",children:[e.jsx("span",{children:"Mobile:"}),e.jsx("span",{children:t.customerMobile})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(ee,{status:t.status,serviceType:t.serviceType,reason:D,className:"mb-2"}),e.jsx("p",{className:"text-lg text-center font-medium text-gray-700",children:R[t.status]||R.Pending}),(t.status==="Cancelled"||t.status==="Returned")&&D&&e.jsxs("p",{className:"text-sm text-center text-gray-600 mt-1",children:["Reason: ",D]}),B&&e.jsx("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg text-center",children:e.jsx("p",{className:"text-green-800 font-medium",children:"Your order has been confirmed and is being prepared by our team."})}),!B&&Y&&e.jsxs("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg text-center",children:[e.jsxs("p",{className:"text-green-800 font-medium",children:["Your order has been accepted by ",Y]}),M&&e.jsxs("p",{className:"text-sm text-gray-700 mt-1",children:["Role: ",M]}),$&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Your server has indicated: ",$]})]})]}),e.jsx("div",{className:"items-list",children:v.map(a=>{const f=Number(a.unitPrice)||0,g=Number(a.amount)||f*(Number(a.quantity)||0);return e.jsxs("div",{className:"item-row",children:[e.jsxs("span",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{children:[a.name,a.quantity>0?` Ã— ${a.quantity}`:""]}),a.returned&&e.jsxs("span",{className:"meta-chip returned-chip",children:["Returned ",a.returnedQuantity]})]}),e.jsx("span",{children:a.quantity>0?`â‚¹${A(g)}`:"Returned"})]},a.name)})}),e.jsxs("div",{className:"summary-totals",children:[e.jsxs("div",{className:"total-row",children:[e.jsx("span",{children:n("totalItems")}),e.jsx("span",{children:L})]}),e.jsxs("div",{className:"total-row",children:[e.jsx("span",{children:n("subtotal")}),e.jsxs("span",{children:["â‚¹",T.subtotal.toFixed(2)]})]}),e.jsxs("div",{className:"total-row total-bold",children:[e.jsx("span",{children:n("total")}),e.jsxs("span",{children:["â‚¹",T.totalAmount.toFixed(2)]})]})]}),e.jsxs("div",{className:"buttons-row",children:[e.jsx("button",{onClick:()=>r("/menu"),className:"primary-btn",children:n("confirmOrder")}),e.jsx("button",{onClick:()=>c(!0),className:"secondary-btn",children:n("viewBill")})]})]})})]}),E&&e.jsx("div",{className:"bill-modal-overlay",children:e.jsxs("div",{className:"bill-modal",children:[e.jsxs("div",{className:"bill-modal-header",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Invoice"}),e.jsxs("p",{className:"invoice-meta",children:[e.jsxs("span",{children:[n("orderId")," ",t._id]}),e.jsx("span",{children:new Date(t.createdAt).toLocaleString()})]})]}),e.jsxs("div",{className:"bill-modal-actions",children:[e.jsx("button",{onClick:V,disabled:l,className:"invoice-action-btn download",children:l?"Preparingâ€¦":"Download"}),e.jsx("button",{onClick:()=>c(!1),className:"invoice-close-btn",children:"âœ•"})]})]}),e.jsxs("div",{ref:b,className:"invoice-preview",children:[e.jsxs("div",{className:"invoice-top",children:[e.jsxs("div",{children:[e.jsx("div",{className:"brand-name",children:t.cafe?.cafeName||t.cafe?.name||"Terra Cart"}),e.jsx("div",{className:"brand-address",children:t.cafe?.address||t.franchise?.address||"â€”"}),(t.franchise?.fssaiNumber||t.franchise?.fssai||t.cafe?.fssaiNumber||t.cafe?.fssai)&&e.jsxs("div",{className:"brand-address",children:["FSSAI No:"," ",t.franchise?.fssaiNumber||t.franchise?.fssai||t.cafe?.fssaiNumber||t.cafe?.fssai]}),(t.franchise?.gstNumber||t.cafe?.gstNumber)&&e.jsxs("div",{className:"brand-address",children:["FSSAI No:"," ",t.franchise?.gstNumber||t.cafe?.gstNumber]})]}),e.jsxs("div",{className:"invoice-meta-block",children:[e.jsxs("div",{className:"meta-line",children:[e.jsx("span",{children:"Invoice No:"}),e.jsx("span",{children:q})]}),x&&t.takeawayToken&&e.jsxs("div",{className:"meta-line",children:[e.jsx("span",{children:"Token:"}),e.jsx("span",{className:"font-bold text-blue-600",children:t.takeawayToken})]}),e.jsxs("div",{className:"meta-line",children:[e.jsx("span",{children:"Date:"}),e.jsx("span",{children:new Date(t.paidAt||t.updatedAt||t.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"meta-line",children:[e.jsx("span",{children:"Time:"}),e.jsx("span",{children:new Date(t.paidAt||t.updatedAt||t.createdAt).toLocaleTimeString()})]})]})]}),e.jsxs("div",{className:"invoice-billed",children:[!x&&e.jsxs("div",{className:"meta-line",children:[e.jsxs("span",{children:[n("serviceTypeLabel"),":"]}),e.jsx("span",{children:F})]}),!x&&e.jsxs("div",{className:"meta-line",children:[e.jsxs("span",{children:[n("tableLabel"),":"]}),e.jsxs("span",{children:[P,w?` Â· ${w}`:""]})]}),x&&(t.customerName||t.customerMobile)&&e.jsxs(e.Fragment,{children:[t.customerName&&e.jsxs("div",{className:"meta-line",children:[e.jsx("span",{children:"Customer Name:"}),e.jsx("span",{children:t.customerName})]}),t.customerMobile&&e.jsxs("div",{className:"meta-line",children:[e.jsx("span",{children:"Mobile Number:"}),e.jsx("span",{children:t.customerMobile})]})]})]}),e.jsxs("table",{className:"invoice-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:n("itemHeader")||"Item"}),e.jsx("th",{children:n("quantityHeader")||"Qty"}),e.jsx("th",{children:n("priceHeader")||"Price (â‚¹)"}),e.jsx("th",{className:"align-right",children:n("amountHeader")||"Amount (â‚¹)"})]})}),e.jsx("tbody",{children:v.length>0?v.map(a=>{const f=Number(a.unitPrice)||0,g=Number(a.amount)||f*(Number(a.quantity)||0);return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{children:a.name}),a.returned&&e.jsxs("span",{className:"invoice-returned-note",children:["Returned ",a.returnedQuantity]})]})}),e.jsx("td",{children:a.quantity>0?a.quantity:"â€”"}),e.jsxs("td",{children:["â‚¹",A(f)]}),e.jsx("td",{className:"align-right",children:a.quantity>0?`â‚¹${A(g)}`:"Returned"})]},a.name)}):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"empty-row",children:"No items found"})})})]}),e.jsxs("div",{className:"invoice-totals",children:[e.jsxs("div",{className:"meta-line",children:[e.jsx("span",{children:n("totalItems")}),e.jsx("span",{children:L})]}),e.jsxs("div",{className:"meta-line",children:[e.jsx("span",{children:n("subtotal")}),e.jsxs("span",{children:["â‚¹",A(T.subtotal)]})]}),e.jsxs("div",{className:"meta-line total",children:[e.jsx("span",{children:n("total")}),e.jsxs("span",{children:["â‚¹",A(T.totalAmount)]})]})]}),e.jsx("div",{className:"invoice-footer",children:"Thank you for dining with Terra Cart. We hope to see you again!"})]})]})})]})}export{_e as default};
